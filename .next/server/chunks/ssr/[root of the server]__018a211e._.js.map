{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/schema.ts"],"sourcesContent":["import {object, string, z} from 'zod';\r\n\r\nconst roles = z.enum([\"CUSTOMER\", \"DESIGNER\"]);\r\n\r\nexport const signUpSchema = object({\r\n    email: string({required_error : \"Email is required\"}).email(\"Invalid email\"),\r\n    password: string({required_error : \"Password is required\"}).min(8,\"Password must be at least 8 characters\").max(32,\"Password must be at most 32 characters\"),\r\n    role: roles\r\n})\r\n\r\nexport const signInSchema = object({\r\n    email: string({required_error : \"Email is required\"}).email(\"Invalid email\"),\r\n    password: string({required_error : \"Password is required\"})\r\n})"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,QAAQ,oIAAA,CAAA,IAAC,CAAC,IAAI,CAAC;IAAC;IAAY;CAAW;AAEtC,MAAM,eAAe,CAAA,GAAA,oIAAA,CAAA,SAAM,AAAD,EAAE;IAC/B,OAAO,CAAA,GAAA,oIAAA,CAAA,SAAM,AAAD,EAAE;QAAC,gBAAiB;IAAmB,GAAG,KAAK,CAAC;IAC5D,UAAU,CAAA,GAAA,oIAAA,CAAA,SAAM,AAAD,EAAE;QAAC,gBAAiB;IAAsB,GAAG,GAAG,CAAC,GAAE,0CAA0C,GAAG,CAAC,IAAG;IACnH,MAAM;AACV;AAEO,MAAM,eAAe,CAAA,GAAA,oIAAA,CAAA,SAAM,AAAD,EAAE;IAC/B,OAAO,CAAA,GAAA,oIAAA,CAAA,SAAM,AAAD,EAAE;QAAC,gBAAiB;IAAmB,GAAG,KAAK,CAAC;IAC5D,UAAU,CAAA,GAAA,oIAAA,CAAA,SAAM,AAAD,EAAE;QAAC,gBAAiB;IAAsB;AAC7D","debugId":null}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/env.js"],"sourcesContent":["import { createEnv } from \"@t3-oss/env-nextjs\";\nimport { z } from \"zod\";\n\nexport const env = createEnv({\n  /**\n   * Specify your server-side environment variables schema here. This way you can ensure the app\n   * isn't built with invalid env vars.\n   */\n  server: {\n    AUTH_SECRET:\n      process.env.NODE_ENV === \"production\"\n        ? z.string()\n        : z.string().optional(),\n    // AUTH_DISCORD_ID: z.string(),\n    // AUTH_DISCORD_SECRET: z.string(),\n    DATABASE_URL: z.string().url(),\n    NODE_ENV: z\n      .enum([\"development\", \"test\", \"production\"])\n      .default(\"development\"),\n  },\n\n  /**\n   * Specify your client-side environment variables schema here. This way you can ensure the app\n   * isn't built with invalid env vars. To expose them to the client, prefix them with\n   * `NEXT_PUBLIC_`.\n   */\n  client: {\n    // NEXT_PUBLIC_CLIENTVAR: z.string(),\n  },\n\n  /**\n   * You can't destruct `process.env` as a regular object in the Next.js edge runtimes (e.g.\n   * middlewares) or client-side so we need to destruct manually.\n   */\n  runtimeEnv: {\n    AUTH_SECRET: process.env.AUTH_SECRET,\n    // AUTH_DISCORD_ID: process.env.AUTH_DISCORD_ID,\n    // AUTH_DISCORD_SECRET: process.env.AUTH_DISCORD_SECRET,\n    DATABASE_URL: process.env.DATABASE_URL,\n    NODE_ENV: process.env.NODE_ENV,\n  },\n  /**\n   * Run `build` or `dev` with `SKIP_ENV_VALIDATION` to skip env validation. This is especially\n   * useful for Docker builds.\n   */\n  skipValidation: !!process.env.SKIP_ENV_VALIDATION,\n  /**\n   * Makes it so that empty strings are treated as undefined. `SOME_VAR: z.string()` and\n   * `SOME_VAR=''` will throw an error.\n   */\n  emptyStringAsUndefined: true,\n});\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,MAAM,MAAM,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD,EAAE;IAC3B;;;GAGC,GACD,QAAQ;QACN,aACE,6EAEI,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;QACzB,+BAA+B;QAC/B,mCAAmC;QACnC,cAAc,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG;QAC5B,UAAU,oIAAA,CAAA,IAAC,CACR,IAAI,CAAC;YAAC;YAAe;YAAQ;SAAa,EAC1C,OAAO,CAAC;IACb;IAEA;;;;GAIC,GACD,QAAQ;IAER;IAEA;;;GAGC,GACD,YAAY;QACV,aAAa,QAAQ,GAAG,CAAC,WAAW;QACpC,gDAAgD;QAChD,wDAAwD;QACxD,cAAc,QAAQ,GAAG,CAAC,YAAY;QACtC,QAAQ;IACV;IACA;;;GAGC,GACD,gBAAgB,CAAC,CAAC,QAAQ,GAAG,CAAC,mBAAmB;IACjD;;;GAGC,GACD,wBAAwB;AAC1B","debugId":null}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/server/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nimport { env } from \"~/env\";\n\nconst createPrismaClient = () =>\n  new PrismaClient({\n    log:\n      env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: ReturnType<typeof createPrismaClient> | undefined;\n};\n\nexport const db = globalForPrisma.prisma ?? createPrismaClient();\n\nif (env.NODE_ENV !== \"production\") globalForPrisma.prisma = db;"],"names":[],"mappings":";;;AAAA;AAEA;;;AAEA,MAAM,qBAAqB,IACzB,IAAI,6HAAA,CAAA,eAAY,CAAC;QACf,KACE,0GAAA,CAAA,MAAG,CAAC,QAAQ,KAAK,gBAAgB;YAAC;YAAS;YAAS;SAAO,GAAG;YAAC;SAAQ;IAC3E;AAEF,MAAM,kBAAkB;AAIjB,MAAM,KAAK,gBAAgB,MAAM,IAAI;AAE5C,IAAI,0GAAA,CAAA,MAAG,CAAC,QAAQ,KAAK,cAAc,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/server/auth/config.ts"],"sourcesContent":["import NextAuth from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport { db } from '~/server/db';\nimport bcrypt from 'bcryptjs';\n\nexport const authOptions = {\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        email: { label: 'Email', type: 'email' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        const user = await db.user.findUnique({\n          where: { email: credentials?.email },\n        });\n\n        if (!user) return null;\n\n        const isValid = await bcrypt.compare(\n          credentials?.password || '',\n          user.password\n        );\n\n        if (!isValid) return null;\n\n        console.log('User authorized:', user); // Debugging\n        return {\n          id: user.id,\n          email: user.email,\n          role: user.role, // Include the role field\n        };\n      },\n    }),\n  ],\n  callbacks: {\n    async session({ session, token }) {\n      console.log('Session callback:', session); // Debugging\n      session.user.id = token.sub; // Add user ID to the session\n      session.user.role = token.role; // Add role to the session\n      return session;\n    },\n    async jwt({ token, user }) {\n      console.log('JWT callback:', token); // Debugging\n      if (user) {\n        token.sub = user.id; // Add user ID to the token\n        token.role = user.role; // Add role to the token\n      }\n      return token;\n    },\n  },\n  pages: {\n    signIn: '/signin', // Custom sign-in page\n  },\n};\n\nexport default NextAuth(authOptions);"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;AACA;AACA;;;;;AAEO,MAAM,cAAc;IACzB,WAAW;QACT,CAAA,GAAA,0JAAA,CAAA,UAAmB,AAAD,EAAE;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,MAAM,OAAO,MAAM,mHAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;oBACpC,OAAO;wBAAE,OAAO,aAAa;oBAAM;gBACrC;gBAEA,IAAI,CAAC,MAAM,OAAO;gBAElB,MAAM,UAAU,MAAM,iIAAA,CAAA,UAAM,CAAC,OAAO,CAClC,aAAa,YAAY,IACzB,KAAK,QAAQ;gBAGf,IAAI,CAAC,SAAS,OAAO;gBAErB,QAAQ,GAAG,CAAC,oBAAoB,OAAO,YAAY;gBACnD,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,QAAQ,GAAG,CAAC,qBAAqB,UAAU,YAAY;YACvD,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG,EAAE,6BAA6B;YAC1D,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI,EAAE,0BAA0B;YAC1D,OAAO;QACT;QACA,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,QAAQ,GAAG,CAAC,iBAAiB,QAAQ,YAAY;YACjD,IAAI,MAAM;gBACR,MAAM,GAAG,GAAG,KAAK,EAAE,EAAE,2BAA2B;gBAChD,MAAM,IAAI,GAAG,KAAK,IAAI,EAAE,wBAAwB;YAClD;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;AACF;uCAEe,CAAA,GAAA,qJAAA,CAAA,UAAQ,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/server/auth/index.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport { cache } from \"react\";\n\nimport { authConfig } from \"./config\";\n\nconst { auth: uncachedAuth, handlers, signIn, signOut } = NextAuth(authConfig);\n\nconst auth = cache(uncachedAuth);\n\nexport { auth, handlers, signIn, signOut };"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AAEA;;;;AAEA,MAAM,EAAE,MAAM,YAAY,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,qJAAA,CAAA,UAAQ,AAAD,EAAE,+HAAA,CAAA,aAAU;AAE7E,MAAM,OAAO,CAAA,GAAA,qMAAA,CAAA,QAAK,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 263, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport bcrypt from 'bcryptjs';\r\nimport { AuthError } from 'next-auth';\r\nimport { redirect } from 'next/navigation';\r\nimport { ZodError } from 'zod';\r\nimport { signUpSchema } from '~/schema';\r\nimport { signIn, signOut } from '~/server/auth';\r\nimport { db } from '~/server/db';\r\n\r\nexport async function signout() {\r\n  await signOut();\r\n}\r\n\r\nexport async function authenticate(\r\n  prevState: string | undefined,\r\n  formData: FormData\r\n) {\r\n  try {\r\n    await signIn('credentials', {\r\n      ...Object.fromEntries(formData),\r\n      redirect: false,\r\n    });\r\n\r\n    redirect('/dashboard');\r\n  } catch (error) {\r\n    if (error instanceof AuthError) {\r\n      switch (error.type) {\r\n        case 'CredentialsSignin':\r\n          return 'Invalid credentials';\r\n        default:\r\n          return 'Something went wrong';\r\n      }\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function register(\r\n  prevState: string | undefined,\r\n  formData: FormData\r\n) {\r\n  try {\r\n    const { email, password, role } = await signUpSchema.parseAsync({\r\n      email: formData.get('email'),\r\n      password: formData.get('password'),\r\n      role: formData.get('role'),\r\n    });\r\n\r\n    const user = await db.user.findUnique({\r\n      where: {\r\n        email: email,\r\n      },\r\n    });\r\n\r\n    if (user) {\r\n      return 'User already exists';\r\n    }\r\n\r\n    const hash = await bcrypt.hash(password, 10);\r\n\r\n    await db.user.create({\r\n      data: {\r\n        email: email,\r\n        password: hash,\r\n        role: role,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    if (error instanceof ZodError) {\r\n      return error.errors.map((error) => error.message).join(', ');\r\n    }\r\n    return 'Something went wrong';\r\n  }\r\n\r\n  redirect('/signin');\r\n}"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEO,eAAe,uCAAK,GAAL;IACpB,MAAM,CAAA,GAAA,8HAAA,CAAA,UAAO,AAAD;AACd;AAEO,eAAe,uCAAU,GAAV,aACpB,SAA6B,EAC7B,QAAkB;IAElB,IAAI;QACF,MAAM,CAAA,GAAA,8HAAA,CAAA,SAAM,AAAD,EAAE,eAAe;YAC1B,GAAG,OAAO,WAAW,CAAC,SAAS;YAC/B,UAAU;QACZ;QAEA,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;IACX,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,wIAAA,CAAA,YAAS,EAAE;YAC9B,OAAQ,MAAM,IAAI;gBAChB,KAAK;oBACH,OAAO;gBACT;oBACE,OAAO;YACX;QACF;QACA,MAAM;IACR;AACF;AAEO,eAAe,uCAAM,GAAN,SACpB,SAA6B,EAC7B,QAAkB;IAElB,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,6GAAA,CAAA,eAAY,CAAC,UAAU,CAAC;YAC9D,OAAO,SAAS,GAAG,CAAC;YACpB,UAAU,SAAS,GAAG,CAAC;YACvB,MAAM,SAAS,GAAG,CAAC;QACrB;QAEA,MAAM,OAAO,MAAM,mHAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YACpC,OAAO;gBACL,OAAO;YACT;QACF;QAEA,IAAI,MAAM;YACR,OAAO;QACT;QAEA,MAAM,OAAO,MAAM,iIAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU;QAEzC,MAAM,mHAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;YACnB,MAAM;gBACJ,OAAO;gBACP,UAAU;gBACV,MAAM;YACR;QACF;IACF,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,oIAAA,CAAA,WAAQ,EAAE;YAC7B,OAAO,MAAM,MAAM,CAAC,GAAG,CAAC,CAAC,QAAU,MAAM,OAAO,EAAE,IAAI,CAAC;QACzD;QACA,OAAO;IACT;IAEA,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;AACX;;;IAlEsB;IAIA;IAwBA;;AA5BA,+OAAA;AAIA,+OAAA;AAwBA,+OAAA","debugId":null}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/signin/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/signin/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/signin/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA2R,GACxT,yDACA","debugId":null}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/signin/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/signin/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/signin/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAuQ,GACpS,qCACA","debugId":null}},
    {"offset": {"line": 436, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}