{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport bcrypt from 'bcryptjs';\r\nimport { AuthError } from 'next-auth';\r\nimport { redirect } from 'next/navigation';\r\nimport { ZodError } from 'zod';\r\nimport { signUpSchema } from '~/schema';\r\nimport { signIn, signOut } from '~/server/auth';\r\nimport { db } from '~/server/db';\r\n\r\nexport async function signout() {\r\n  await signOut();\r\n}\r\n\r\nexport async function authenticate(\r\n  prevState: string | undefined,\r\n  formData: FormData\r\n) {\r\n  try {\r\n    await signIn('credentials',formData);\r\n\r\n  } catch (error) {\r\n    if (error instanceof AuthError) {\r\n      switch (error.type) {\r\n        case 'CredentialsSignin':\r\n          return 'Invalid credentials';\r\n        default:\r\n          return 'Something went wrong';\r\n      }\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function register(\r\n  prevState: string | undefined,\r\n  formData: FormData\r\n) {\r\n  try {\r\n    const { email, password, role } = await signUpSchema.parseAsync({\r\n      email: formData.get('email'),\r\n      password: formData.get('password'),\r\n      role: formData.get('role'),\r\n    });\r\n\r\n    const user = await db.user.findUnique({\r\n      where: {\r\n        email: email,\r\n      },\r\n    });\r\n\r\n    if (user) {\r\n      return 'User already exists';\r\n    }\r\n\r\n    const hash = await bcrypt.hash(password, 10);\r\n\r\n    await db.user.create({\r\n      data: {\r\n        email: email,\r\n        password: hash,\r\n        role: role,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    if (error instanceof ZodError) {\r\n      return error.errors.map((error) => error.message).join(', ');\r\n    }\r\n    return 'Something went wrong';\r\n  }\r\n\r\n  redirect('/signin');\r\n}"],"names":[],"mappings":";;;;;;;IAUsB;IAIA;IAoBA","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/signup/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useActionState } from 'react';\r\nimport { register } from '../actions/auth';\r\nimport { useStateContext } from '../contexts/ContextProvider';\r\n\r\nexport default function Page() {\r\n  const [errorMessage, formAction, isPending] = useActionState(\r\n    register,\r\n    undefined\r\n  );\r\n  const {role,setRole} = useStateContext()\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen items-center justify-center bg-white px-4\">\r\n      <div className=\"w-full max-w-sm space-y-6\">\r\n\r\n      <Link\r\n          href=\"/\"\r\n          className=\"inline-flex items-center text-sm text-gray-600 hover:text-gray-900\"\r\n        >\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className=\"h-5 w-5 mr-2\"\r\n            viewBox=\"0 0 20 20\"\r\n            fill=\"currentColor\"\r\n          >\r\n            <path\r\n              fillRule=\"evenodd\"\r\n              d=\"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z\"\r\n              clipRule=\"evenodd\"\r\n            />\r\n          </svg>\r\n          Go Back to Homepage\r\n        </Link>\r\n        \r\n        <h1 className=\"rounded-lg border-2 border-blue-600 bg-blue-600 px-6 py-1 text-center text-2xl font-bold text-white\">\r\n          Sign Up\r\n        </h1>\r\n        <form action={formAction} className=\"space-y-4\">\r\n          <input type=\"hidden\" name=\"redirectTo\" value={role === \"CUSTOMER\" ? \"/cus_dashboard\" : \"/des_dashboard\"}/>\r\n          \r\n          <div className=\"relative h-fit\">\r\n            <input\r\n              className=\"w-full rounded-md border border-gray-300 text-sm px-3 pb-1 pt-7 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 focus:outline-none\"\r\n              type=\"email\"\r\n              name=\"email\"\r\n              required\r\n            />\r\n            <label className=\"absolute left-3 top-2 text-[12px] text-gray-500\">\r\n              Email\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"relative h-fit\">\r\n            <input\r\n              className=\"w-full rounded-md border border-gray-300 text-sm px-3 pb-1 pt-7 focus:border-blue-600 focus:ring-2 focus:ring-blue-600 focus:outline-none\"\r\n              type=\"password\"\r\n              name=\"password\"\r\n              required\r\n              minLength={8}\r\n            />\r\n            <label className=\"absolute left-3 top-2 text-[12px] text-gray-500\">\r\n              Password\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-gray-700\">Choose your role</p>\r\n            <div className=\"flex gap-4\">\r\n              \r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"role\"\r\n                  value=\"CUSTOMER\"\r\n                  onChange={() => setRole(\"CUSTOMER\")}\r\n                  className=\"h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-600\"\r\n                  defaultChecked\r\n                />\r\n                <span className=\"text-sm text-gray-700\">Customer</span>\r\n              </label>\r\n\r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"role\"\r\n                  value=\"DESIGNER\"\r\n                  onChange={() => setRole('DESIGNER')}\r\n                  className=\"h-4 w-4 border-gray-300 text-blue-600 focus:ring-blue-600\"\r\n                />\r\n                <span className=\"text-sm text-gray-700\">Designer</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            disabled={isPending}\r\n            className=\"w-full rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:bg-blue-400\"\r\n          >\r\n            {isPending ? 'Registering...' : 'Register'}\r\n          </button>\r\n\r\n          <p className=\"text-center text-sm text-gray-600\">\r\n            Have an account?{' '}\r\n            <Link\r\n              href=\"/signin\"\r\n              className=\"font-medium text-blue-600 hover:text-blue-700\"\r\n            >\r\n              Sign in\r\n            </Link>\r\n          </p>\r\n\r\n          {errorMessage && (\r\n            <p className=\"text-center text-sm text-red-500\">{errorMessage}</p>\r\n          )}\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,CAAC,cAAc,YAAY,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,iBAAc,AAAD,EACzD,6HAAA,CAAA,WAAQ,EACR;IAEF,MAAM,EAAC,IAAI,EAAC,OAAO,EAAC,GAAG,CAAA,GAAA,0IAAA,CAAA,kBAAe,AAAD;IAErC,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEf,8OAAC,4JAAA,CAAA,UAAI;oBACD,MAAK;oBACL,WAAU;;sCAEV,8OAAC;4BACC,OAAM;4BACN,WAAU;4BACV,SAAQ;4BACR,MAAK;sCAEL,cAAA,8OAAC;gCACC,UAAS;gCACT,GAAE;gCACF,UAAS;;;;;;;;;;;wBAEP;;;;;;;8BAIR,8OAAC;oBAAG,WAAU;8BAAsG;;;;;;8BAGpH,8OAAC;oBAAK,QAAQ;oBAAY,WAAU;;sCAClC,8OAAC;4BAAM,MAAK;4BAAS,MAAK;4BAAa,OAAO,SAAS,aAAa,mBAAmB;;;;;;sCAEvF,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,WAAU;oCACV,MAAK;oCACL,MAAK;oCACL,QAAQ;;;;;;8CAEV,8OAAC;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;sCAKrE,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,WAAU;oCACV,MAAK;oCACL,MAAK;oCACL,QAAQ;oCACR,WAAW;;;;;;8CAEb,8OAAC;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;sCAKrE,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAE,WAAU;8CAAwB;;;;;;8CACrC,8OAAC;oCAAI,WAAU;;sDAEb,8OAAC;4CAAM,WAAU;;8DACf,8OAAC;oDACC,MAAK;oDACL,MAAK;oDACL,OAAM;oDACN,UAAU,IAAM,QAAQ;oDACxB,WAAU;oDACV,cAAc;;;;;;8DAEhB,8OAAC;oDAAK,WAAU;8DAAwB;;;;;;;;;;;;sDAG1C,8OAAC;4CAAM,WAAU;;8DACf,8OAAC;oDACC,MAAK;oDACL,MAAK;oDACL,OAAM;oDACN,UAAU,IAAM,QAAQ;oDACxB,WAAU;;;;;;8DAEZ,8OAAC;oDAAK,WAAU;8DAAwB;;;;;;;;;;;;;;;;;;;;;;;;sCAK9C,8OAAC;4BACC,UAAU;4BACV,WAAU;sCAET,YAAY,mBAAmB;;;;;;sCAGlC,8OAAC;4BAAE,WAAU;;gCAAoC;gCAC9B;8CACjB,8OAAC,4JAAA,CAAA,UAAI;oCACH,MAAK;oCACL,WAAU;8CACX;;;;;;;;;;;;wBAKF,8BACC,8OAAC;4BAAE,WAAU;sCAAoC;;;;;;;;;;;;;;;;;;;;;;;AAM7D","debugId":null}}]
}