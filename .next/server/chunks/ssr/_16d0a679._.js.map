{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport bcrypt from 'bcryptjs';\r\nimport { AuthError } from 'next-auth';\r\nimport { redirect } from 'next/navigation';\r\nimport { ZodError } from 'zod';\r\nimport { signUpSchema } from '~/schema';\r\nimport { signIn, signOut } from '~/server/auth';\r\nimport { db } from '~/server/db';\r\n\r\nexport async function signout() {\r\n  await signOut();\r\n}\r\n\r\nexport async function authenticate(\r\n  prevState: string | undefined,\r\n  formData: FormData\r\n) {\r\n  try {\r\n    await signIn('credentials',formData);\r\n\r\n  } catch (error) {\r\n    if (error instanceof AuthError) {\r\n      switch (error.type) {\r\n        case 'CredentialsSignin':\r\n          return 'Invalid credentials';\r\n        default:\r\n          return 'Something went wrong';\r\n      }\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function register(\r\n  prevState: string | undefined,\r\n  formData: FormData\r\n) {\r\n  try {\r\n    const { email, password, role } = await signUpSchema.parseAsync({\r\n      email: formData.get('email'),\r\n      password: formData.get('password'),\r\n      role: formData.get('role'),\r\n    });\r\n\r\n    const user = await db.user.findUnique({\r\n      where: {\r\n        email: email,\r\n      },\r\n    });\r\n\r\n    if (user) {\r\n      return 'User already exists';\r\n    }\r\n\r\n    const hash = await bcrypt.hash(password, 10);\r\n\r\n    await db.user.create({\r\n      data: {\r\n        email: email,\r\n        password: hash,\r\n        role: role,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    if (error instanceof ZodError) {\r\n      return error.errors.map((error) => error.message).join(', ');\r\n    }\r\n    return 'Something went wrong';\r\n  }\r\n\r\n  redirect('/signin');\r\n}"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEO,eAAe,uCAAK,GAAL;IACpB,MAAM,CAAA,GAAA,8HAAA,CAAA,UAAO,AAAD;AACd;AAEO,eAAe,uCAAU,GAAV,aACpB,SAA6B,EAC7B,QAAkB;IAElB,IAAI;QACF,MAAM,CAAA,GAAA,8HAAA,CAAA,SAAM,AAAD,EAAE,eAAc;IAE7B,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,wIAAA,CAAA,YAAS,EAAE;YAC9B,OAAQ,MAAM,IAAI;gBAChB,KAAK;oBACH,OAAO;gBACT;oBACE,OAAO;YACX;QACF;QACA,MAAM;IACR;AACF;AAEO,eAAe,uCAAM,GAAN,SACpB,SAA6B,EAC7B,QAAkB;IAElB,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,6GAAA,CAAA,eAAY,CAAC,UAAU,CAAC;YAC9D,OAAO,SAAS,GAAG,CAAC;YACpB,UAAU,SAAS,GAAG,CAAC;YACvB,MAAM,SAAS,GAAG,CAAC;QACrB;QAEA,MAAM,OAAO,MAAM,mHAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YACpC,OAAO;gBACL,OAAO;YACT;QACF;QAEA,IAAI,MAAM;YACR,OAAO;QACT;QAEA,MAAM,OAAO,MAAM,iIAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU;QAEzC,MAAM,mHAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;YACnB,MAAM;gBACJ,OAAO;gBACP,UAAU;gBACV,MAAM;YACR;QACF;IACF,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,oIAAA,CAAA,WAAQ,EAAE;YAC7B,OAAO,MAAM,MAAM,CAAC,GAAG,CAAC,CAAC,QAAU,MAAM,OAAO,EAAE,IAAI,CAAC;QACzD;QACA,OAAO;IACT;IAEA,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;AACX;;;IA9DsB;IAIA;IAoBA;;AAxBA,+OAAA;AAIA,+OAAA;AAoBA,+OAAA","debugId":null}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/signin/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/signin/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/signin/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA2R,GACxT,yDACA","debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alloy/Desktop/React%20Projects/grad/src/app/signin/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/signin/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/signin/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAuQ,GACpS,qCACA","debugId":null}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}